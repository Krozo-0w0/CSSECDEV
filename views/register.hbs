<div class="centerBox">
    <div class="childContainer borderDefault">
        <div>
            <h1> Register </h1>
        </div>
        <hr>
            <div> 
                <form action="register-checker" method="post">
                    <div id="emailErrorContainer">
                        {{emailErrMsg}}
                    </div>
                    <input class="inputBox" type="text" placeholder="Email" id="email" name="email"></input>
                    <input class="inputBox" type="text" placeholder="Username" id="username" name="username"></input>
                    <div class="passwordErrorContainer">
                        <input class="inputBox" type="password" placeholder="Password" id="password" name="password"></input>
                    </div>
                    <div id="vPasswordErrorContainer">
                        {{vpassErrMsg}}
                    </div>
                    <input class="inputBox" type="password" placeholder="Verify Password" id="vpassword" name="vpassword"></input>
                    
                    <!-- Security Questions Section -->
                    <div class="security-questions">
                        <h4>Security Questions</h4>
                        <p>Please select and answer 3 security questions:</p>
                        
                        <!-- Question 1 -->
                        <select class="inputBox security-question" name="securityQuestion1" required>
                            <option value="">Select Question 1</option>
                            <option value="What was the name of your favorite childhood pet?">What was the name of your favorite childhood pet?</option>
                            <option value="In what city or town did your parents meet?">In what city or town did your parents meet?</option>
                            <option value="What is your favorite sport?">What is your favorite sport?</option>
                            <option value="What was the first concert you attended?">What was the first concert you attended?</option>
                            <option value="What breed of dog do you like the most?">What breed of dog do you like the most?</option>
                            <option value="In which area of the city is your place of work located?">In which area of the city is your place of work located?</option>
                            <option value="What is your oldest sibling's middle name?">What is your oldest sibling's middle name?</option>
                            <option value="What is your favorite movie?">What is your favorite movie?</option>
                            <option value="How many siblings do you have?">How many siblings do you have?</option>
                        </select>
                        <input class="inputBox" type="text" placeholder="Answer for Question 1" name="securityAnswer1" required>
                        
                        <!-- Question 2 -->
                        <select class="inputBox security-question" name="securityQuestion2" required>
                            <option value="">Select Question 2</option>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                        <input class="inputBox" type="text" placeholder="Answer for Question 2" name="securityAnswer2" required>
                        
                        <!-- Question 3 -->
                        <select class="inputBox security-question" name="securityQuestion3" required>
                            <option value="">Select Question 3</option>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                        <input class="inputBox" type="text" placeholder="Answer for Question 3" name="securityAnswer3" required>
                    </div>

                    <div class="">
                        <h4><input type="checkbox" name="isTechnician"></input>I am a Laboratory Technician (Admin)</h4>
                        <h4><input type="checkbox" name="isRoleA"></input>I am a lab Manager (Role A)</h4>
                    </div>
                    <input class="button" type="submit" value="Register" id="register-btn">
                </form>
            </div>

        <hr>
        <h4> Already have an Account? <a href="/"> Log in </a></h4>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const allQuestions = [
        "What was the name of your favorite childhood pet?",
        "In what city or town did your parents meet?",
        "What is your favorite sport?",
        "What was the first concert you attended?",
        "What breed of dog do you like the most?",
        "In which area of the city is your place of work located?",
        "What is your oldest sibling's middle name?",
        "What is your favorite movie?",
        "How many siblings do you have?"
    ];

    const questionSelects = document.querySelectorAll('.security-question');
    
    // Initialize all dropdowns with all questions
    questionSelects.forEach((select, index) => {
        // Clear existing options except the first one
        while(select.options.length > 1) {
            select.remove(1);
        }
        
        // Add all questions as options
        allQuestions.forEach(question => {
            const option = document.createElement('option');
            option.value = question;
            option.textContent = question;
            select.appendChild(option);
        });
    });

    // Function to update available questions based on selections
    function updateAvailableQuestions() {
        const selectedQuestions = Array.from(questionSelects).map(select => select.value).filter(val => val);
        
        questionSelects.forEach((select, index) => {
            const currentValue = select.value;
            
            // Enable all options first
            Array.from(select.options).forEach(option => {
                option.disabled = false;
            });
            
            // Disable selected questions from other dropdowns
            selectedQuestions.forEach(question => {
                if (question && question !== currentValue) {
                    Array.from(select.options).forEach(option => {
                        if (option.value === question) {
                            option.disabled = true;
                        }
                    });
                }
            });
        });
    }

    // Add event listeners to all question selects
    questionSelects.forEach(select => {
        select.addEventListener('change', updateAvailableQuestions);
    });

    // Initial update
    updateAvailableQuestions();
});
</script>